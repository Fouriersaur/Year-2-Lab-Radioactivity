import matplotlib.pyplot as plt
import numpy as np
import os
import re

input_path = '/kaggle/input/datasets/jackyu74/16feb-data'
file_list = []
distance = []

if os.path.exists(input_path):
    for filename in sorted(os.listdir(input_path)):
        match = re.search(r'(\d+)cm', filename)
        d_value = int(match.group(1))
        distance.append(d_value)
        file_list.append(filename)
        
print(distance)
ndd_list = []
uncertainty_ndd_list = []

for idx, i in enumerate(file_list):
    file_path = f"{input_path}/{i}" # 1. Update the path to current file
    data = []                       # 2. Reset list so means don't stay the same
    with open(file_path, 'r') as file:
        for line in file:
            line = line.strip()
            if line: 
                data.append(float(line))
                
    mean_val = np.mean(data)
    std_val = np.std(data)
    d = distance[idx]
    fff = d*d*mean_val
    sss = 4*mean_val*mean_val*0.05*0.05
    ndd = mean_val*d*d
    uncertainty_ndd = np.sqrt(fff+sss)*d
    ndd_list.append(ndd)
    uncertainty_ndd_list.append(uncertainty_ndd)
    print(f"File: {i} | Mean: {mean_val} | Std: {std_val} | d: {d} | ndd: {ndd} | uncer_ndd: {uncertainty_ndd} | relative_uncer_ndd: {uncertainty_ndd/ndd}")
    
    

plt.errorbar(distance, ndd_list, yerr = uncertainty_ndd_list, fmt = "o")